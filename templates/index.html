{% extends 'base.html' %}

{% block title %}Главная{% endblock %}

{% block content %}
<!-- Hero Slider -->
{% if sliders %}
<div id="mainSlider" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-indicators">
        {% for slider in sliders %}
            <button type="button" data-bs-target="#mainSlider" data-bs-slide-to="{{ loop.index0 }}" 
                    {% if loop.first %}class="active" aria-current="true"{% endif %} 
                    aria-label="Slide {{ loop.index }}"></button>
        {% endfor %}
    </div>
    <div class="carousel-inner">
        {% for slider in sliders %}
            <div class="carousel-item {% if loop.first %}active{% endif %}">
                <div class="slider-container">
                    <img src="{{ slider.image_url }}" class="d-block w-100 h-100 object-fit-cover" alt="{{ slider.title }}">
                    <div class="slider-overlay">
                        <div class="slider-content">
                            {% if slider.title %}<h2>{{ slider.title }}</h2>{% endif %}
                            {% if slider.subtitle %}<p>{{ slider.subtitle }}</p>{% endif %}
                            {% if slider.button_text and slider.button_url %}
                                <a href="{{ slider.button_url }}" class="btn btn-primary btn-lg">{{ slider.button_text }}</a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#mainSlider" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Предыдущий</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#mainSlider" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Следующий</span>
    </button>
</div>
{% endif %}

<!-- Categories Section -->
<section class="py-5">
    <div class="container">
        <h2 class="section-title">Категории мероприятий</h2>
        <div class="row">
            {% for category in categories %}
            <div class="col-6 col-md-4 col-lg-2">
                <a href="{{ url_for('events', category=category.id) }}" class="text-decoration-none text-dark">
                    <div class="category-box">
                        <i class="fas {{ category.icon }}"></i>
                        <h4>{{ category.name }}</h4>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Popular Events Section -->
<section class="py-5 bg-light">
    <div class="container">
        <h2 class="section-title">Популярные события</h2>
        <div class="row">
            {% for event in popular_events %}
            <div class="col-md-6 col-lg-4 mb-4">
                <div class="event-card">
                    <div class="event-image" style="background-image: url('{{ event.image_url }}');">
                        <div class="event-date">
                            <span class="day-month">{{ event.date|format_date }}</span>
                        </div>
                    </div>
                    <div class="event-info">
                        <h3 class="event-title">{{ event.title }}</h3>
                        <div class="event-venue">
                            <i class="fas fa-map-marker-alt me-1"></i> {{ event.venue.name }}
                        </div>
                        <div class="event-price">
                            <i class="fas fa-ticket-alt me-1"></i> {{ event.price_range }}
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="favorite-btn" data-event-id="{{ event.id }}" 
                                data-require-login="{{ 'true' if not current_user.is_authenticated else 'false' }}">
                            <i class="{% if current_user.is_authenticated and event in current_user.favorites %}fas{% else %}far{% endif %} fa-heart"></i>
                        </button>
                        <a href="{{ url_for('event_detail', event_id=event.id) }}" class="btn btn-primary">Купить билет</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="text-center mt-4">
            <a href="{{ url_for('events') }}" class="btn btn-outline-primary">Посмотреть все события</a>
        </div>
    </div>
</section>

<!-- Upcoming Events Section -->
<section class="py-5">
    <div class="container">
        <h2 class="section-title">Ближайшие события</h2>
        <div class="row">
            {% for event in upcoming_events %}
            <div class="col-md-6 col-lg-4 mb-4">
                <div class="event-card">
                    <div class="event-image" style="background-image: url('{{ event.image_url }}');">
                        <div class="event-date">
                            <span class="day-month">{{ event.date|format_date }}</span>
                        </div>
                    </div>
                    <div class="event-info">
                        <h3 class="event-title">{{ event.title }}</h3>
                        <div class="event-venue">
                            <i class="fas fa-map-marker-alt me-1"></i> {{ event.venue.name }}
                        </div>
                        <div class="event-price">
                            <i class="fas fa-ticket-alt me-1"></i> {{ event.price_range }}
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="favorite-btn" data-event-id="{{ event.id }}"
                                data-require-login="{{ 'true' if not current_user.is_authenticated else 'false' }}">
                            <i class="{% if current_user.is_authenticated and event in current_user.favorites %}fas{% else %}far{% endif %} fa-heart"></i>
                        </button>
                        <a href="{{ url_for('event_detail', event_id=event.id) }}" class="btn btn-primary">Купить билет</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="text-center mt-4">
            <a href="{{ url_for('events') }}" class="btn btn-outline-primary">Посмотреть все события</a>
        </div>
    </div>
</section>

<!-- Sell Your Ticket CTA Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-7">
                <h2 class="mb-4">Хотите продать свой билет?</h2>
                <p class="lead mb-4">У вас есть лишние билеты на мероприятие? Вы можете разместить их на нашей платформе и найти покупателя быстро и безопасно.</p>
                <a href="{{ url_for('sell_ticket') }}" class="btn btn-primary btn-lg">Продать билет</a>
            </div>
            <div class="col-md-5">
                <div class="text-center">
                    <i class="fas fa-ticket-alt fa-10x text-primary-lighten-40 mb-3"></i>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
